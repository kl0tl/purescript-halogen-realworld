// Generated by purs version 0.13.8
"use strict";
var Control_Alt = require("../Control.Alt/index.js");
var Data_Array = require("../Data.Array/index.js");
var Data_Boolean = require("../Data.Boolean/index.js");
var Data_Date = require("../Data.Date/index.js");
var Data_Date_Component = require("../Data.Date.Component/index.js");
var Data_DateTime_Instant = require("../Data.DateTime.Instant/index.js");
var Data_Either = require("../Data.Either/index.js");
var Data_Enum = require("../Data.Enum/index.js");
var Data_EuclideanRing = require("../Data.EuclideanRing/index.js");
var Data_Foldable = require("../Data.Foldable/index.js");
var Data_Formatter_Parser_Utils = require("../Data.Formatter.Parser.Utils/index.js");
var Data_Functor = require("../Data.Functor/index.js");
var Data_Identity = require("../Data.Identity/index.js");
var Data_Int = require("../Data.Int/index.js");
var Data_List = require("../Data.List/index.js");
var Data_List_Types = require("../Data.List.Types/index.js");
var Data_Monoid = require("../Data.Monoid/index.js");
var Data_Newtype = require("../Data.Newtype/index.js");
var Data_Ord = require("../Data.Ord/index.js");
var Data_Ring = require("../Data.Ring/index.js");
var Data_Show = require("../Data.Show/index.js");
var Data_String_CodePoints = require("../Data.String.CodePoints/index.js");
var Data_String_CodeUnits = require("../Data.String.CodeUnits/index.js");
var Data_Time = require("../Data.Time/index.js");
var Data_Time_Component = require("../Data.Time.Component/index.js");
var Data_Time_Duration = require("../Data.Time.Duration/index.js");
var Data_Tuple = require("../Data.Tuple/index.js");
var Text_Parsing_Parser = require("../Text.Parsing.Parser/index.js");
var Text_Parsing_Parser_Combinators = require("../Text.Parsing.Parser.Combinators/index.js");
var Text_Parsing_Parser_String = require("../Text.Parsing.Parser.String/index.js");
var YearFull = (function () {
    function YearFull() {

    };
    YearFull.value = new YearFull();
    return YearFull;
})();
var YearTwoDigits = (function () {
    function YearTwoDigits() {

    };
    YearTwoDigits.value = new YearTwoDigits();
    return YearTwoDigits;
})();
var YearAbsolute = (function () {
    function YearAbsolute() {

    };
    YearAbsolute.value = new YearAbsolute();
    return YearAbsolute;
})();
var MonthFull = (function () {
    function MonthFull() {

    };
    MonthFull.value = new MonthFull();
    return MonthFull;
})();
var MonthShort = (function () {
    function MonthShort() {

    };
    MonthShort.value = new MonthShort();
    return MonthShort;
})();
var MonthTwoDigits = (function () {
    function MonthTwoDigits() {

    };
    MonthTwoDigits.value = new MonthTwoDigits();
    return MonthTwoDigits;
})();
var DayOfMonthTwoDigits = (function () {
    function DayOfMonthTwoDigits() {

    };
    DayOfMonthTwoDigits.value = new DayOfMonthTwoDigits();
    return DayOfMonthTwoDigits;
})();
var DayOfMonth = (function () {
    function DayOfMonth() {

    };
    DayOfMonth.value = new DayOfMonth();
    return DayOfMonth;
})();
var UnixTimestamp = (function () {
    function UnixTimestamp() {

    };
    UnixTimestamp.value = new UnixTimestamp();
    return UnixTimestamp;
})();
var DayOfWeek = (function () {
    function DayOfWeek() {

    };
    DayOfWeek.value = new DayOfWeek();
    return DayOfWeek;
})();
var DayOfWeekName = (function () {
    function DayOfWeekName() {

    };
    DayOfWeekName.value = new DayOfWeekName();
    return DayOfWeekName;
})();
var DayOfWeekNameShort = (function () {
    function DayOfWeekNameShort() {

    };
    DayOfWeekNameShort.value = new DayOfWeekNameShort();
    return DayOfWeekNameShort;
})();
var Hours24 = (function () {
    function Hours24() {

    };
    Hours24.value = new Hours24();
    return Hours24;
})();
var Hours12 = (function () {
    function Hours12() {

    };
    Hours12.value = new Hours12();
    return Hours12;
})();
var Meridiem = (function () {
    function Meridiem() {

    };
    Meridiem.value = new Meridiem();
    return Meridiem;
})();
var Minutes = (function () {
    function Minutes() {

    };
    Minutes.value = new Minutes();
    return Minutes;
})();
var MinutesTwoDigits = (function () {
    function MinutesTwoDigits() {

    };
    MinutesTwoDigits.value = new MinutesTwoDigits();
    return MinutesTwoDigits;
})();
var Seconds = (function () {
    function Seconds() {

    };
    Seconds.value = new Seconds();
    return Seconds;
})();
var SecondsTwoDigits = (function () {
    function SecondsTwoDigits() {

    };
    SecondsTwoDigits.value = new SecondsTwoDigits();
    return SecondsTwoDigits;
})();
var Milliseconds = (function () {
    function Milliseconds() {

    };
    Milliseconds.value = new Milliseconds();
    return Milliseconds;
})();
var MillisecondsShort = (function () {
    function MillisecondsShort() {

    };
    MillisecondsShort.value = new MillisecondsShort();
    return MillisecondsShort;
})();
var MillisecondsTwoDigits = (function () {
    function MillisecondsTwoDigits() {

    };
    MillisecondsTwoDigits.value = new MillisecondsTwoDigits();
    return MillisecondsTwoDigits;
})();
var Placeholder = (function () {
    function Placeholder(value0) {
        this.value0 = value0;
    };
    Placeholder.create = function (value0) {
        return new Placeholder(value0);
    };
    return Placeholder;
})();
var printShortMonth = function (v) {
    if (v instanceof Data_Date_Component.January) {
        return "Jan";
    };
    if (v instanceof Data_Date_Component.February) {
        return "Feb";
    };
    if (v instanceof Data_Date_Component.March) {
        return "Mar";
    };
    if (v instanceof Data_Date_Component.April) {
        return "Apr";
    };
    if (v instanceof Data_Date_Component.May) {
        return "May";
    };
    if (v instanceof Data_Date_Component.June) {
        return "Jun";
    };
    if (v instanceof Data_Date_Component.July) {
        return "Jul";
    };
    if (v instanceof Data_Date_Component.August) {
        return "Aug";
    };
    if (v instanceof Data_Date_Component.September) {
        return "Sep";
    };
    if (v instanceof Data_Date_Component.October) {
        return "Oct";
    };
    if (v instanceof Data_Date_Component.November) {
        return "Nov";
    };
    if (v instanceof Data_Date_Component.December) {
        return "Dec";
    };
    throw new Error("Failed pattern match at Data.Formatter.DateTime (line 482, column 19 - line 494, column 21): " + [ v.constructor.name ]);
};
var placeholderContent = Data_Functor.mapFlipped(Text_Parsing_Parser.functorParserT(Data_Identity.functorIdentity))(Data_Array.some(Text_Parsing_Parser.alternativeParserT(Data_Identity.monadIdentity))(Text_Parsing_Parser.lazyParserT)(Text_Parsing_Parser_String.noneOf(Text_Parsing_Parser_String.stringLikeString)(Data_Identity.monadIdentity)(Data_String_CodeUnits.toCharArray("YMDEHhamsS"))))(Data_String_CodeUnits.fromCharArray);
var padSingleDigit = function (i) {
    if (i < 0) {
        return "-" + padSingleDigit(-i | 0);
    };
    if (i < 10) {
        return "0" + Data_Show.show(Data_Show.showInt)(i);
    };
    if (Data_Boolean.otherwise) {
        return Data_Show.show(Data_Show.showInt)(i);
    };
    throw new Error("Failed pattern match at Data.Formatter.DateTime (line 192, column 1 - line 192, column 30): " + [ i.constructor.name ]);
};
var padQuadrupleDigit = function (i) {
    if (i < 0) {
        return "-" + padQuadrupleDigit(-i | 0);
    };
    if (i < 10) {
        return "000" + Data_Show.show(Data_Show.showInt)(i);
    };
    if (i < 100) {
        return "00" + Data_Show.show(Data_Show.showInt)(i);
    };
    if (i < 1000) {
        return "0" + Data_Show.show(Data_Show.showInt)(i);
    };
    if (Data_Boolean.otherwise) {
        return Data_Show.show(Data_Show.showInt)(i);
    };
    throw new Error("Failed pattern match at Data.Formatter.DateTime (line 205, column 1 - line 205, column 33): " + [ i.constructor.name ]);
};
var padDoubleDigit = function (i) {
    if (i < 0) {
        return "-" + padDoubleDigit(-i | 0);
    };
    if (i < 10) {
        return "00" + Data_Show.show(Data_Show.showInt)(i);
    };
    if (i < 100) {
        return "0" + Data_Show.show(Data_Show.showInt)(i);
    };
    if (Data_Boolean.otherwise) {
        return Data_Show.show(Data_Show.showInt)(i);
    };
    throw new Error("Failed pattern match at Data.Formatter.DateTime (line 198, column 1 - line 198, column 30): " + [ i.constructor.name ]);
};
var formatterCommandParser = Control_Alt.alt(Text_Parsing_Parser.altParserT(Data_Identity.monadIdentity))(Data_Formatter_Parser_Utils.oneOfAs(Data_Functor.functorArray)(Data_Foldable.foldableArray)(Data_Identity.monadIdentity)((function () {
    var $1260 = Text_Parsing_Parser_Combinators["try"](Data_Identity.monadIdentity);
    var $1261 = Text_Parsing_Parser_String.string(Text_Parsing_Parser_String.stringLikeString)(Data_Identity.monadIdentity);
    return function ($1262) {
        return $1260($1261($1262));
    };
})())([ new Data_Tuple.Tuple("YYYY", YearFull.value), new Data_Tuple.Tuple("YY", YearTwoDigits.value), new Data_Tuple.Tuple("Y", YearAbsolute.value), new Data_Tuple.Tuple("MMMM", MonthFull.value), new Data_Tuple.Tuple("MMM", MonthShort.value), new Data_Tuple.Tuple("MM", MonthTwoDigits.value), new Data_Tuple.Tuple("DD", DayOfMonthTwoDigits.value), new Data_Tuple.Tuple("D", DayOfMonth.value), new Data_Tuple.Tuple("E", DayOfWeek.value), new Data_Tuple.Tuple("X", UnixTimestamp.value), new Data_Tuple.Tuple("dddd", DayOfWeekName.value), new Data_Tuple.Tuple("ddd", DayOfWeekNameShort.value), new Data_Tuple.Tuple("HH", Hours24.value), new Data_Tuple.Tuple("hh", Hours12.value), new Data_Tuple.Tuple("a", Meridiem.value), new Data_Tuple.Tuple("mm", MinutesTwoDigits.value), new Data_Tuple.Tuple("m", Minutes.value), new Data_Tuple.Tuple("ss", SecondsTwoDigits.value), new Data_Tuple.Tuple("s", Seconds.value), new Data_Tuple.Tuple("SSS", Milliseconds.value), new Data_Tuple.Tuple("SS", MillisecondsTwoDigits.value), new Data_Tuple.Tuple("S", MillisecondsShort.value) ]))(Data_Functor.map(Text_Parsing_Parser.functorParserT(Data_Identity.functorIdentity))(Placeholder.create)(placeholderContent));
var formatYearTwoDigits = function (i) {
    var dateString = Data_Show.show(Data_Show.showInt)(Data_Ord.abs(Data_Ord.ordInt)(Data_Ring.ringInt)(i));
    var dateLength = Data_String_CodePoints.length(dateString);
    if (dateLength === 1) {
        return "0" + dateString;
    };
    if (dateLength === 2) {
        return dateString;
    };
    return Data_String_CodePoints.drop(dateLength - 2 | 0)(dateString);
};
var formatParser = Data_List.some(Text_Parsing_Parser.alternativeParserT(Data_Identity.monadIdentity))(Text_Parsing_Parser.lazyParserT)(formatterCommandParser);
var parseFormatString = Data_Formatter_Parser_Utils.runP(Text_Parsing_Parser_String.stringLikeString)(formatParser);
var fix12 = function (h) {
    var $1253 = h === 0;
    if ($1253) {
        return 12;
    };
    return h;
};
var formatCommand = function (v) {
    return function (v1) {
        if (v1 instanceof YearFull) {
            return padQuadrupleDigit(Data_Enum.fromEnum(Data_Date_Component.boundedEnumYear)(Data_Date.year(v.value0)));
        };
        if (v1 instanceof YearTwoDigits) {
            return formatYearTwoDigits(Data_Enum.fromEnum(Data_Date_Component.boundedEnumYear)(Data_Date.year(v.value0)));
        };
        if (v1 instanceof YearAbsolute) {
            return Data_Show.show(Data_Show.showInt)(Data_Enum.fromEnum(Data_Date_Component.boundedEnumYear)(Data_Date.year(v.value0)));
        };
        if (v1 instanceof MonthFull) {
            return Data_Show.show(Data_Date_Component.showMonth)(Data_Date.month(v.value0));
        };
        if (v1 instanceof MonthShort) {
            return printShortMonth(Data_Date.month(v.value0));
        };
        if (v1 instanceof MonthTwoDigits) {
            return padSingleDigit(Data_Enum.fromEnum(Data_Date_Component.boundedEnumMonth)(Data_Date.month(v.value0)));
        };
        if (v1 instanceof DayOfMonthTwoDigits) {
            return padSingleDigit(Data_Enum.fromEnum(Data_Date_Component.boundedEnumDay)(Data_Date.day(v.value0)));
        };
        if (v1 instanceof DayOfMonth) {
            return Data_Show.show(Data_Show.showInt)(Data_Enum.fromEnum(Data_Date_Component.boundedEnumDay)(Data_Date.day(v.value0)));
        };
        if (v1 instanceof UnixTimestamp) {
            return Data_Show.show(Data_Show.showInt)(Data_Int.floor((function (v2) {
                return v2 / 1000.0;
            })(Data_Newtype.unwrap(Data_Time_Duration.newtypeMilliseconds)(Data_DateTime_Instant.unInstant(Data_DateTime_Instant.fromDateTime(v))))));
        };
        if (v1 instanceof DayOfWeek) {
            return Data_Show.show(Data_Show.showInt)(Data_Enum.fromEnum(Data_Date_Component.boundedEnumWeekday)(Data_Date.weekday(v.value0)));
        };
        if (v1 instanceof DayOfWeekName) {
            return Data_Show.show(Data_Date_Component.showWeekday)(Data_Date.weekday(v.value0));
        };
        if (v1 instanceof DayOfWeekNameShort) {
            return Data_String_CodePoints.take(3)(Data_Show.show(Data_Date_Component.showWeekday)(Data_Date.weekday(v.value0)));
        };
        if (v1 instanceof Hours24) {
            return padSingleDigit(Data_Enum.fromEnum(Data_Time_Component.boundedEnumHour)(Data_Time.hour(v.value1)));
        };
        if (v1 instanceof Hours12) {
            return padSingleDigit(fix12(Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt)(Data_Enum.fromEnum(Data_Time_Component.boundedEnumHour)(Data_Time.hour(v.value1)))(12)));
        };
        if (v1 instanceof Meridiem) {
            var $1256 = Data_Enum.fromEnum(Data_Time_Component.boundedEnumHour)(Data_Time.hour(v.value1)) >= 12;
            if ($1256) {
                return "PM";
            };
            return "AM";
        };
        if (v1 instanceof Minutes) {
            return Data_Show.show(Data_Show.showInt)(Data_Enum.fromEnum(Data_Time_Component.boundedEnumMinute)(Data_Time.minute(v.value1)));
        };
        if (v1 instanceof MinutesTwoDigits) {
            return padSingleDigit(Data_Enum.fromEnum(Data_Time_Component.boundedEnumMinute)(Data_Time.minute(v.value1)));
        };
        if (v1 instanceof Seconds) {
            return Data_Show.show(Data_Show.showInt)(Data_Enum.fromEnum(Data_Time_Component.boundedEnumSecond)(Data_Time.second(v.value1)));
        };
        if (v1 instanceof SecondsTwoDigits) {
            return padSingleDigit(Data_Enum.fromEnum(Data_Time_Component.boundedEnumSecond)(Data_Time.second(v.value1)));
        };
        if (v1 instanceof Milliseconds) {
            return padDoubleDigit(Data_Enum.fromEnum(Data_Time_Component.boundedEnumMillisecond)(Data_Time.millisecond(v.value1)));
        };
        if (v1 instanceof MillisecondsShort) {
            return Data_Show.show(Data_Show.showInt)((function (v2) {
                return Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)(v2)(100);
            })(Data_Enum.fromEnum(Data_Time_Component.boundedEnumMillisecond)(Data_Time.millisecond(v.value1))));
        };
        if (v1 instanceof MillisecondsTwoDigits) {
            return padSingleDigit((function (v2) {
                return Data_EuclideanRing.div(Data_EuclideanRing.euclideanRingInt)(v2)(10);
            })(Data_Enum.fromEnum(Data_Time_Component.boundedEnumMillisecond)(Data_Time.millisecond(v.value1))));
        };
        if (v1 instanceof Placeholder) {
            return v1.value0;
        };
        throw new Error("Failed pattern match at Data.Formatter.DateTime (line 167, column 38 - line 190, column 20): " + [ v1.constructor.name ]);
    };
};
var format = function (f) {
    return function (d) {
        return Data_Foldable.foldMap(Data_List_Types.foldableList)(Data_Monoid.monoidString)(formatCommand(d))(f);
    };
};
var formatDateTime = function (pattern) {
    return function (datetime) {
        return Data_Functor.mapFlipped(Data_Either.functorEither)(parseFormatString(pattern))(function (v) {
            return format(v)(datetime);
        });
    };
};
module.exports = {
    YearFull: YearFull,
    YearTwoDigits: YearTwoDigits,
    YearAbsolute: YearAbsolute,
    MonthFull: MonthFull,
    MonthShort: MonthShort,
    MonthTwoDigits: MonthTwoDigits,
    DayOfMonthTwoDigits: DayOfMonthTwoDigits,
    DayOfMonth: DayOfMonth,
    UnixTimestamp: UnixTimestamp,
    DayOfWeek: DayOfWeek,
    DayOfWeekName: DayOfWeekName,
    DayOfWeekNameShort: DayOfWeekNameShort,
    Hours24: Hours24,
    Hours12: Hours12,
    Meridiem: Meridiem,
    Minutes: Minutes,
    MinutesTwoDigits: MinutesTwoDigits,
    Seconds: Seconds,
    SecondsTwoDigits: SecondsTwoDigits,
    Milliseconds: Milliseconds,
    MillisecondsShort: MillisecondsShort,
    MillisecondsTwoDigits: MillisecondsTwoDigits,
    Placeholder: Placeholder,
    parseFormatString: parseFormatString,
    format: format,
    formatDateTime: formatDateTime
};
