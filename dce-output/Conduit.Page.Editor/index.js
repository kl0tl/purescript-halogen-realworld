// Generated by purs version 0.13.6
import * as Component_HOC_Connect from "../Component.HOC.Connect/index.js";
import * as Conduit_Capability_Navigate from "../Conduit.Capability.Navigate/index.js";
import * as Conduit_Capability_Resource_Article from "../Conduit.Capability.Resource.Article/index.js";
import * as Conduit_Component_HTML_Header from "../Conduit.Component.HTML.Header/index.js";
import * as Conduit_Component_HTML_Utils from "../Conduit.Component.HTML.Utils/index.js";
import * as Conduit_Component_TagInput from "../Conduit.Component.TagInput/index.js";
import * as Conduit_Data_Route from "../Conduit.Data.Route/index.js";
import * as Conduit_Form_Field from "../Conduit.Form.Field/index.js";
import * as Conduit_Form_Validation from "../Conduit.Form.Validation/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Monad_State_Class from "../Control.Monad.State.Class/index.js";
import * as Control_Semigroupoid from "../Control.Semigroupoid/index.js";
import * as DOM_HTML_Indexed_InputType from "../DOM.HTML.Indexed.InputType/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Monoid from "../Data.Monoid/index.js";
import * as Data_Newtype from "../Data.Newtype/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Set from "../Data.Set/index.js";
import * as Data_Symbol from "../Data.Symbol/index.js";
import * as Data_Unfoldable from "../Data.Unfoldable/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Formless_Action from "../Formless.Action/index.js";
import * as Formless_Class_Initial from "../Formless.Class.Initial/index.js";
import * as Formless_Component from "../Formless.Component/index.js";
import * as Formless_Internal_Transform from "../Formless.Internal.Transform/index.js";
import * as Formless_Query from "../Formless.Query/index.js";
import * as Formless_Retrieve from "../Formless.Retrieve/index.js";
import * as Formless_Transform_Record from "../Formless.Transform.Record/index.js";
import * as Formless_Transform_Row from "../Formless.Transform.Row/index.js";
import * as Formless_Types_Component from "../Formless.Types.Component/index.js";
import * as Formless_Types_Form from "../Formless.Types.Form/index.js";
import * as Formless_Validation from "../Formless.Validation/index.js";
import * as Halogen_Component from "../Halogen.Component/index.js";
import * as Halogen_HTML from "../Halogen.HTML/index.js";
import * as Halogen_HTML_Core from "../Halogen.HTML.Core/index.js";
import * as Halogen_HTML_Elements from "../Halogen.HTML.Elements/index.js";
import * as Halogen_HTML_Events from "../Halogen.HTML.Events/index.js";
import * as Halogen_HTML_Properties from "../Halogen.HTML.Properties/index.js";
import * as Halogen_Query_HalogenM from "../Halogen.Query.HalogenM/index.js";
import * as Heterogeneous_Mapping from "../Heterogeneous.Mapping/index.js";
import * as Network_RemoteData from "../Network.RemoteData/index.js";
import * as Slug from "../Slug/index.js";
var HandleTagInput = (function () {
    function HandleTagInput(value0) {
        this.value0 = value0;
    };
    HandleTagInput.create = function (value0) {
        return new HandleTagInput(value0);
    };
    return HandleTagInput;
})();
var EditorFields = function (x) {
    return x;
};
var Initialize = (function () {
    function Initialize() {

    };
    Initialize.value = new Initialize();
    return Initialize;
})();
var Receive = (function () {
    function Receive(value0) {
        this.value0 = value0;
    };
    Receive.create = function (value0) {
        return new Receive(value0);
    };
    return Receive;
})();
var HandleEditor = (function () {
    function HandleEditor(value0) {
        this.value0 = value0;
    };
    HandleEditor.create = function (value0) {
        return new HandleEditor(value0);
    };
    return HandleEditor;
})();
var newtypeEditorFields = new Data_Newtype.Newtype(function (n) {
    return n;
}, EditorFields);
var formComponent = function (dictMonadAff) {
    return function (mbArticle) {
        var proxies = Formless_Transform_Row.mkSProxies()(newtypeEditorFields)(Formless_Transform_Row.makeSProxiesCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "body";
        }))()(Formless_Transform_Row.makeSProxiesCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "description";
        }))()(Formless_Transform_Row.makeSProxiesCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "tagList";
        }))()(Formless_Transform_Row.makeSProxiesCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "title";
        }))()(Formless_Transform_Row.makeSProxiesNil)))))(Formless_Types_Form.FormProxy.value);
        var render = function (v) {
            var title = Conduit_Form_Field.input(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                return "title";
            }))(newtypeEditorFields)(newtypeEditorFields)()()(proxies.title)(v.form)([ Halogen_HTML_Properties.placeholder("Article Title"), Halogen_HTML_Properties.type_(Halogen_HTML_Core.isPropInputType)(DOM_HTML_Indexed_InputType.InputText.value) ]);
            var tags = Data_Set.fromFoldable(Data_Foldable.foldableArray)(Conduit_Component_TagInput.ordTag)(Formless_Retrieve.getInput(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                return "tagList";
            }))(newtypeEditorFields)()(proxies.tagList)(v.form));
            var handler = function ($542) {
                return Data_Maybe.Just.create(Formless_Action.injAction(HandleTagInput.create($542)));
            };
            var description = Conduit_Form_Field.input(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                return "description";
            }))(newtypeEditorFields)(newtypeEditorFields)()()(proxies.description)(v.form)([ Halogen_HTML_Properties.placeholder("What's this article about?"), Halogen_HTML_Properties.type_(Halogen_HTML_Core.isPropInputType)(DOM_HTML_Indexed_InputType.InputText.value) ]);
            var body = Halogen_HTML_Elements.fieldset([ Conduit_Component_HTML_Utils.css("form-group") ])([ Halogen_HTML_Elements.textarea([ Conduit_Component_HTML_Utils.css("form-control form-control-lg"), Halogen_HTML_Properties.placeholder("Write your article (in markdown)"), Halogen_HTML_Properties.value(Formless_Retrieve.getInput(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                return "body";
            }))(newtypeEditorFields)()(proxies.body)(v.form)), Halogen_HTML_Properties.rows(8), Halogen_HTML_Events.onValueInput((function () {
                var $543 = Formless_Action.setValidate(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "body";
                }))(newtypeEditorFields)()(proxies.body);
                return function ($544) {
                    return Data_Maybe.Just.create($543($544));
                };
            })()) ]), Conduit_Component_HTML_Utils.maybeElem(Formless_Retrieve.getError(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                return "body";
            }))(newtypeEditorFields)()(proxies.body)(v.form))(function (err) {
                return Halogen_HTML_Elements.div([ Conduit_Component_HTML_Utils.css("error-messages") ])([ Halogen_HTML_Core.text(Conduit_Form_Validation.errorToString(err)) ]);
            }) ]);
            return Halogen_HTML_Elements.form_([ Halogen_HTML_Elements.fieldset_([ title, description, body, Halogen_HTML.slot()(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                return "tagInput";
            }))(Data_Ord.ordUnit)(Data_Symbol.SProxy.value)(Data_Unit.unit)(Conduit_Component_TagInput.component(dictMonadAff.MonadEffect0()))({
                tags: tags
            })(handler), Conduit_Form_Field.submit((function () {
                var $503 = Data_Maybe.isJust(mbArticle);
                if ($503) {
                    return "Commit changes";
                };
                return "Publish";
            })()) ]) ]);
        };
        var handleAction = (function () {
            var $$eval = function (act) {
                return Formless_Component.handleAction(dictMonadAff)()()(Data_Eq.eqRowCons(Data_Eq.eqRowCons(Data_Eq.eqRowCons(Data_Eq.eqRowCons(Data_Eq.eqRowNil)()(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "title";
                }))(Formless_Types_Form.eqInputField(Data_Eq.eqString)))()(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "tagList";
                }))(Formless_Types_Form.eqInputField(Data_Eq.eqArray(Conduit_Component_TagInput.eqTag))))()(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "description";
                }))(Formless_Types_Form.eqInputField(Data_Eq.eqString)))()(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "body";
                }))(Formless_Types_Form.eqInputField(Data_Eq.eqString)))(Formless_Internal_Transform.inputFieldsToFormFieldsCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "body";
                }))()(Formless_Internal_Transform.inputFieldsToFormFieldsCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "description";
                }))()(Formless_Internal_Transform.inputFieldsToFormFieldsCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "tagList";
                }))()(Formless_Internal_Transform.inputFieldsToFormFieldsCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "title";
                }))()(Formless_Internal_Transform.inputFieldsToFormFieldsNil)())())())())(Formless_Internal_Transform.inputFieldsToInputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "body";
                }))()(Formless_Internal_Transform.inputFieldsToInputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "description";
                }))()(Formless_Internal_Transform.inputFieldsToInputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "tagList";
                }))()(Formless_Internal_Transform.inputFieldsToInputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "title";
                }))()(Formless_Internal_Transform.inputFieldsToInputNil)())())())())(Formless_Internal_Transform.consCountErrors(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "body";
                }))()(Formless_Internal_Transform.consCountErrors(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "description";
                }))()(Formless_Internal_Transform.consCountErrors(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "tagList";
                }))()(Formless_Internal_Transform.consCountErrors(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "title";
                }))()(Formless_Internal_Transform.nilCountErrors)))))(Formless_Internal_Transform.consAllTouched(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "body";
                }))()(Formless_Internal_Transform.consAllTouched(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "description";
                }))()(Formless_Internal_Transform.consAllTouched(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "tagList";
                }))()(Formless_Internal_Transform.consAllTouched(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "title";
                }))()(Formless_Internal_Transform.nilAllTouched)))))(Formless_Internal_Transform.setFormFieldsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "body";
                }))()(Formless_Internal_Transform.setFormFieldsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "description";
                }))()(Formless_Internal_Transform.setFormFieldsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "tagList";
                }))()(Formless_Internal_Transform.setFormFieldsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "title";
                }))()(Formless_Internal_Transform.setFormFieldsTouchedNil)())())())())(Formless_Internal_Transform.replaceFormFieldInputsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "body";
                }))(Formless_Types_Form.newtypeInputField)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.replaceFormFieldInputsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "description";
                }))(Formless_Types_Form.newtypeInputField)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.replaceFormFieldInputsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "tagList";
                }))(Formless_Types_Form.newtypeInputField)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.replaceFormFieldInputsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "title";
                }))(Formless_Types_Form.newtypeInputField)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.replaceFormFieldInputsTouchedNil)))))(Formless_Internal_Transform.modifyAllCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "body";
                }))(Formless_Types_Form.newtypeInputFunction)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.modifyAllCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "description";
                }))(Formless_Types_Form.newtypeInputFunction)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.modifyAllCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "tagList";
                }))(Formless_Types_Form.newtypeInputFunction)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.modifyAllCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "title";
                }))(Formless_Types_Form.newtypeInputFunction)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.modifyAllNil)))))(Formless_Internal_Transform.applyToValidationCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "body";
                }))((dictMonadAff.MonadEffect0()).Monad0())()(newtypeEditorFields)()()(Formless_Internal_Transform.applyToValidationCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "description";
                }))((dictMonadAff.MonadEffect0()).Monad0())()(newtypeEditorFields)()()(Formless_Internal_Transform.applyToValidationCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "tagList";
                }))((dictMonadAff.MonadEffect0()).Monad0())()(newtypeEditorFields)()()(Formless_Internal_Transform.applyToValidationCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "title";
                }))((dictMonadAff.MonadEffect0()).Monad0())()(newtypeEditorFields)()()(Formless_Internal_Transform.applyToValidationNil((dictMonadAff.MonadEffect0()).Monad0()))))))(Formless_Internal_Transform.formFieldsToMaybeOutputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "body";
                }))()(Formless_Internal_Transform.formFieldsToMaybeOutputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "description";
                }))()(Formless_Internal_Transform.formFieldsToMaybeOutputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "tagList";
                }))()(Formless_Internal_Transform.formFieldsToMaybeOutputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "title";
                }))()(Formless_Internal_Transform.formFieldsToMaybeOutputNil)())())())())(newtypeEditorFields)(newtypeEditorFields)(newtypeEditorFields)(newtypeEditorFields)(newtypeEditorFields)(newtypeEditorFields)(newtypeEditorFields)(newtypeEditorFields)()(handleAction)(Formless_Component.raiseResult(newtypeEditorFields)(Heterogeneous_Mapping.hmapRecord()(Heterogeneous_Mapping.mapRecordWithIndexCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "body";
                }))(Heterogeneous_Mapping.constMapping(Formless_Transform_Record.unwrapField(Formless_Types_Form.newtypeOutputField)))(Heterogeneous_Mapping.mapRecordWithIndexCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "description";
                }))(Heterogeneous_Mapping.constMapping(Formless_Transform_Record.unwrapField(Formless_Types_Form.newtypeOutputField)))(Heterogeneous_Mapping.mapRecordWithIndexCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "tagList";
                }))(Heterogeneous_Mapping.constMapping(Formless_Transform_Record.unwrapField(Formless_Types_Form.newtypeOutputField)))(Heterogeneous_Mapping.mapRecordWithIndexCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "title";
                }))(Heterogeneous_Mapping.constMapping(Formless_Transform_Record.unwrapField(Formless_Types_Form.newtypeOutputField)))(Heterogeneous_Mapping.mapRecordWithIndexNil)()())()())()())()())))(act);
            };
            return function (v) {
                if (v.value0 instanceof Conduit_Component_TagInput.TagAdded) {
                    return $$eval(Formless_Action.set(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "tagList";
                    }))(newtypeEditorFields)()(proxies.tagList)(Data_Set.toUnfoldable(Data_Unfoldable.unfoldableArray)(v.value0.value1)));
                };
                if (v.value0 instanceof Conduit_Component_TagInput.TagRemoved) {
                    return $$eval(Formless_Action.set(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "tagList";
                    }))(newtypeEditorFields)()(proxies.tagList)(Data_Set.toUnfoldable(Data_Unfoldable.unfoldableArray)(v.value0.value1)));
                };
                throw new Error("Failed pattern match at Conduit.Page.Editor (line 168, column 27 - line 172, column 60): " + [ v.value0.constructor.name ]);
            };
        })();
        var formInput = function (v) {
            return {
                validators: {
                    title: Control_Semigroupoid.composeFlipped(Formless_Validation.semigroupoidValidation((dictMonadAff.MonadEffect0()).Monad0()))(Conduit_Form_Validation.required(Data_Eq.eqString)(Data_Monoid.monoidString)((dictMonadAff.MonadEffect0()).Monad0()))(Conduit_Form_Validation.minLength((dictMonadAff.MonadEffect0()).Monad0())(1)),
                    description: Control_Semigroupoid.composeFlipped(Formless_Validation.semigroupoidValidation((dictMonadAff.MonadEffect0()).Monad0()))(Conduit_Form_Validation.required(Data_Eq.eqString)(Data_Monoid.monoidString)((dictMonadAff.MonadEffect0()).Monad0()))(Conduit_Form_Validation.minLength((dictMonadAff.MonadEffect0()).Monad0())(1)),
                    body: Control_Semigroupoid.composeFlipped(Formless_Validation.semigroupoidValidation((dictMonadAff.MonadEffect0()).Monad0()))(Conduit_Form_Validation.required(Data_Eq.eqString)(Data_Monoid.monoidString)((dictMonadAff.MonadEffect0()).Monad0()))(Conduit_Form_Validation.minLength((dictMonadAff.MonadEffect0()).Monad0())(3)),
                    tagList: Formless_Validation.hoistFn_((dictMonadAff.MonadEffect0()).Monad0())(Data_Functor.map(Data_Functor.functorArray)(Data_Newtype.unwrap(Conduit_Component_TagInput.newtypeTag)))
                },
                initialInputs: Data_Maybe.Nothing.value
            };
        };
        return Formless_Component.component(dictMonadAff)()()(Data_Eq.eqRowCons(Data_Eq.eqRowCons(Data_Eq.eqRowCons(Data_Eq.eqRowCons(Data_Eq.eqRowNil)()(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "title";
        }))(Formless_Types_Form.eqInputField(Data_Eq.eqString)))()(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "tagList";
        }))(Formless_Types_Form.eqInputField(Data_Eq.eqArray(Conduit_Component_TagInput.eqTag))))()(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "description";
        }))(Formless_Types_Form.eqInputField(Data_Eq.eqString)))()(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "body";
        }))(Formless_Types_Form.eqInputField(Data_Eq.eqString)))(Formless_Internal_Transform.inputFieldsToFormFieldsCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "body";
        }))()(Formless_Internal_Transform.inputFieldsToFormFieldsCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "description";
        }))()(Formless_Internal_Transform.inputFieldsToFormFieldsCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "tagList";
        }))()(Formless_Internal_Transform.inputFieldsToFormFieldsCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "title";
        }))()(Formless_Internal_Transform.inputFieldsToFormFieldsNil)())())())())(Formless_Internal_Transform.inputFieldsToInputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "body";
        }))()(Formless_Internal_Transform.inputFieldsToInputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "description";
        }))()(Formless_Internal_Transform.inputFieldsToInputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "tagList";
        }))()(Formless_Internal_Transform.inputFieldsToInputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "title";
        }))()(Formless_Internal_Transform.inputFieldsToInputNil)())())())())(Formless_Internal_Transform.consCountErrors(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "body";
        }))()(Formless_Internal_Transform.consCountErrors(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "description";
        }))()(Formless_Internal_Transform.consCountErrors(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "tagList";
        }))()(Formless_Internal_Transform.consCountErrors(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "title";
        }))()(Formless_Internal_Transform.nilCountErrors)))))(Formless_Internal_Transform.consAllTouched(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "body";
        }))()(Formless_Internal_Transform.consAllTouched(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "description";
        }))()(Formless_Internal_Transform.consAllTouched(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "tagList";
        }))()(Formless_Internal_Transform.consAllTouched(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "title";
        }))()(Formless_Internal_Transform.nilAllTouched)))))(Formless_Internal_Transform.setFormFieldsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "body";
        }))()(Formless_Internal_Transform.setFormFieldsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "description";
        }))()(Formless_Internal_Transform.setFormFieldsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "tagList";
        }))()(Formless_Internal_Transform.setFormFieldsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "title";
        }))()(Formless_Internal_Transform.setFormFieldsTouchedNil)())())())())(Formless_Internal_Transform.replaceFormFieldInputsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "body";
        }))(Formless_Types_Form.newtypeInputField)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.replaceFormFieldInputsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "description";
        }))(Formless_Types_Form.newtypeInputField)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.replaceFormFieldInputsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "tagList";
        }))(Formless_Types_Form.newtypeInputField)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.replaceFormFieldInputsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "title";
        }))(Formless_Types_Form.newtypeInputField)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.replaceFormFieldInputsTouchedNil)))))(Formless_Internal_Transform.modifyAllCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "body";
        }))(Formless_Types_Form.newtypeInputFunction)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.modifyAllCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "description";
        }))(Formless_Types_Form.newtypeInputFunction)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.modifyAllCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "tagList";
        }))(Formless_Types_Form.newtypeInputFunction)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.modifyAllCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "title";
        }))(Formless_Types_Form.newtypeInputFunction)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.modifyAllNil)))))(Formless_Internal_Transform.applyToValidationCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "body";
        }))((dictMonadAff.MonadEffect0()).Monad0())()(newtypeEditorFields)()()(Formless_Internal_Transform.applyToValidationCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "description";
        }))((dictMonadAff.MonadEffect0()).Monad0())()(newtypeEditorFields)()()(Formless_Internal_Transform.applyToValidationCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "tagList";
        }))((dictMonadAff.MonadEffect0()).Monad0())()(newtypeEditorFields)()()(Formless_Internal_Transform.applyToValidationCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "title";
        }))((dictMonadAff.MonadEffect0()).Monad0())()(newtypeEditorFields)()()(Formless_Internal_Transform.applyToValidationNil((dictMonadAff.MonadEffect0()).Monad0()))))))(Formless_Internal_Transform.formFieldsToMaybeOutputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "body";
        }))()(Formless_Internal_Transform.formFieldsToMaybeOutputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "description";
        }))()(Formless_Internal_Transform.formFieldsToMaybeOutputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "tagList";
        }))()(Formless_Internal_Transform.formFieldsToMaybeOutputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "title";
        }))()(Formless_Internal_Transform.formFieldsToMaybeOutputNil)())())())())(Formless_Transform_Row.mkInputFieldsFromRowCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "body";
        }))(Formless_Class_Initial.initialString)()(Formless_Transform_Row.mkInputFieldsFromRowCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "description";
        }))(Formless_Class_Initial.initialString)()(Formless_Transform_Row.mkInputFieldsFromRowCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "tagList";
        }))(Formless_Class_Initial.initialArray)()(Formless_Transform_Row.mkInputFieldsFromRowCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
            return "title";
        }))(Formless_Class_Initial.initialString)()(Formless_Transform_Row.mkInputFieldsFromRowNil)())())())())(newtypeEditorFields)(newtypeEditorFields)(newtypeEditorFields)(newtypeEditorFields)(newtypeEditorFields)(newtypeEditorFields)(newtypeEditorFields)(newtypeEditorFields)()()()()()()()()()(formInput)({
            render: render,
            handleAction: handleAction,
            handleQuery: Formless_Component.defaultSpec.handleQuery,
            handleEvent: Formless_Component.raiseResult(newtypeEditorFields)(Heterogeneous_Mapping.hmapRecord()(Heterogeneous_Mapping.mapRecordWithIndexCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                return "body";
            }))(Heterogeneous_Mapping.constMapping(Formless_Transform_Record.unwrapField(Formless_Types_Form.newtypeOutputField)))(Heterogeneous_Mapping.mapRecordWithIndexCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                return "description";
            }))(Heterogeneous_Mapping.constMapping(Formless_Transform_Record.unwrapField(Formless_Types_Form.newtypeOutputField)))(Heterogeneous_Mapping.mapRecordWithIndexCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                return "tagList";
            }))(Heterogeneous_Mapping.constMapping(Formless_Transform_Record.unwrapField(Formless_Types_Form.newtypeOutputField)))(Heterogeneous_Mapping.mapRecordWithIndexCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                return "title";
            }))(Heterogeneous_Mapping.constMapping(Formless_Transform_Record.unwrapField(Formless_Types_Form.newtypeOutputField)))(Heterogeneous_Mapping.mapRecordWithIndexNil)()())()())()())()())),
            receive: Formless_Component.defaultSpec.receive,
            initialize: Formless_Component.defaultSpec.initialize,
            finalize: Formless_Component.defaultSpec.finalize
        });
    };
};
var component = function (dictMonadAff) {
    return function (dictMonadAsk) {
        return function (dictNavigate) {
            return function (dictManageArticle) {
                var render = function (v) {
                    return Halogen_HTML_Elements.div_([ Conduit_Component_HTML_Header.header(v.currentUser)(Conduit_Data_Route.Editor.value), Halogen_HTML_Elements.div([ Conduit_Component_HTML_Utils.css("editor-page") ])([ Halogen_HTML_Elements.div([ Conduit_Component_HTML_Utils.css("container page") ])([ Halogen_HTML_Elements.div([ Conduit_Component_HTML_Utils.css("row") ])([ Halogen_HTML_Elements.div([ Conduit_Component_HTML_Utils.css("col-md-10 offset-md-1 col-xs-12") ])([ Halogen_HTML.slot()(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "formless";
                    }))(Data_Ord.ordUnit)(Formless_Types_Component["_formless"])(Data_Unit.unit)(formComponent(dictMonadAff)(Network_RemoteData.toMaybe(v.article)))(Data_Unit.unit)(function ($545) {
                        return Data_Maybe.Just.create(HandleEditor.create($545));
                    }) ]) ]) ]) ]) ]);
                };
                var handleAction = function (v) {
                    if (v instanceof Initialize) {
                        return Control_Bind.bind(Halogen_Query_HalogenM.bindHalogenM)(Control_Monad_State_Class.get(Halogen_Query_HalogenM.monadStateHalogenM))(function (st) {
                            return Data_Foldable.for_(Halogen_Query_HalogenM.applicativeHalogenM)(Data_Foldable.foldableMaybe)(st.slug)(function (slug) {
                                return Control_Bind.discard(Control_Bind.discardUnit)(Halogen_Query_HalogenM.bindHalogenM)(Control_Monad_State_Class.modify_(Halogen_Query_HalogenM.monadStateHalogenM)(function (v1) {
                                    var $516 = {};
                                    for (var $517 in v1) {
                                        if ({}.hasOwnProperty.call(v1, $517)) {
                                            $516[$517] = v1[$517];
                                        };
                                    };
                                    $516.article = Network_RemoteData.Loading.value;
                                    return $516;
                                }))(function ($dollar__unused) {
                                    return Control_Bind.bind(Halogen_Query_HalogenM.bindHalogenM)(Conduit_Capability_Resource_Article.getArticle(Conduit_Capability_Resource_Article.manageArticleHalogenM(dictManageArticle))(slug))(function (mbArticle) {
                                        return Control_Bind.discard(Control_Bind.discardUnit)(Halogen_Query_HalogenM.bindHalogenM)(Control_Monad_State_Class.modify_(Halogen_Query_HalogenM.monadStateHalogenM)(function (v1) {
                                            var $519 = {};
                                            for (var $520 in v1) {
                                                if ({}.hasOwnProperty.call(v1, $520)) {
                                                    $519[$520] = v1[$520];
                                                };
                                            };
                                            $519.article = Network_RemoteData.fromMaybe(mbArticle);
                                            return $519;
                                        }))(function ($dollar__unused) {
                                            return Data_Foldable.for_(Halogen_Query_HalogenM.applicativeHalogenM)(Data_Foldable.foldableMaybe)(mbArticle)(function (v1) {
                                                var newFields = Formless_Transform_Record.wrapInputFields(newtypeEditorFields)(Heterogeneous_Mapping.hmapRecord()(Heterogeneous_Mapping.mapRecordWithIndexCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                                                    return "body";
                                                }))(Heterogeneous_Mapping.constMapping(Formless_Transform_Record.wrapField(Formless_Types_Form.newtypeInputField)))(Heterogeneous_Mapping.mapRecordWithIndexCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                                                    return "description";
                                                }))(Heterogeneous_Mapping.constMapping(Formless_Transform_Record.wrapField(Formless_Types_Form.newtypeInputField)))(Heterogeneous_Mapping.mapRecordWithIndexCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                                                    return "tagList";
                                                }))(Heterogeneous_Mapping.constMapping(Formless_Transform_Record.wrapField(Formless_Types_Form.newtypeInputField)))(Heterogeneous_Mapping.mapRecordWithIndexCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                                                    return "title";
                                                }))(Heterogeneous_Mapping.constMapping(Formless_Transform_Record.wrapField(Formless_Types_Form.newtypeInputField)))(Heterogeneous_Mapping.mapRecordWithIndexNil)()())()())()())()()))({
                                                    title: v1.title,
                                                    description: v1.description,
                                                    body: v1.body,
                                                    tagList: Data_Functor.map(Data_Functor.functorArray)(Conduit_Component_TagInput.Tag)(v1.tagList)
                                                });
                                                return Control_Bind.bind(Halogen_Query_HalogenM.bindHalogenM)(Halogen_Query_HalogenM.query()(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                                                    return "formless";
                                                }))(Data_Ord.ordUnit)(Formless_Types_Component["_formless"])(Data_Unit.unit)(Formless_Query.asQuery(Formless_Action.loadForm(newFields))))(function ($dollar__unused) {
                                                    return Control_Applicative.pure(Halogen_Query_HalogenM.applicativeHalogenM)(Data_Unit.unit);
                                                });
                                            });
                                        });
                                    });
                                });
                            });
                        });
                    };
                    if (v instanceof Receive) {
                        return Control_Bind.bind(Halogen_Query_HalogenM.bindHalogenM)(Control_Monad_State_Class.modify(Halogen_Query_HalogenM.monadStateHalogenM)(function (v1) {
                            var $527 = {};
                            for (var $528 in v1) {
                                if ({}.hasOwnProperty.call(v1, $528)) {
                                    $527[$528] = v1[$528];
                                };
                            };
                            $527.currentUser = v.value0.currentUser;
                            return $527;
                        }))(function (st) {
                            return Control_Applicative.when(Halogen_Query_HalogenM.applicativeHalogenM)(Data_Eq.notEq(Data_Maybe.eqMaybe(Slug.eqSlug))(v.value0.slug)(st.slug))(handleAction(Initialize.value));
                        });
                    };
                    if (v instanceof HandleEditor) {
                        return Control_Bind.bind(Halogen_Query_HalogenM.bindHalogenM)(Control_Monad_State_Class.get(Halogen_Query_HalogenM.monadStateHalogenM))(function (st) {
                            return Control_Bind.bind(Halogen_Query_HalogenM.bindHalogenM)((function () {
                                if (st.slug instanceof Data_Maybe.Nothing) {
                                    return Conduit_Capability_Resource_Article.createArticle(Conduit_Capability_Resource_Article.manageArticleHalogenM(dictManageArticle))(v.value0);
                                };
                                if (st.slug instanceof Data_Maybe.Just) {
                                    return Conduit_Capability_Resource_Article.updateArticle(Conduit_Capability_Resource_Article.manageArticleHalogenM(dictManageArticle))(st.slug.value0)(v.value0);
                                };
                                throw new Error("Failed pattern match at Conduit.Page.Editor (line 96, column 32 - line 98, column 42): " + [ st.slug.constructor.name ]);
                            })())(function (mbArticleWithMetadata) {
                                var slug = Data_Functor.map(Data_Maybe.functorMaybe)(function (v1) {
                                    return v1.slug;
                                })(mbArticleWithMetadata);
                                return Control_Bind.discard(Control_Bind.discardUnit)(Halogen_Query_HalogenM.bindHalogenM)(Control_Monad_State_Class.modify_(Halogen_Query_HalogenM.monadStateHalogenM)(function (v1) {
                                    var $535 = {};
                                    for (var $536 in v1) {
                                        if ({}.hasOwnProperty.call(v1, $536)) {
                                            $535[$536] = v1[$536];
                                        };
                                    };
                                    $535.article = Network_RemoteData.fromMaybe(mbArticleWithMetadata);
                                    $535.slug = slug;
                                    return $535;
                                }))(function ($dollar__unused) {
                                    return Data_Foldable.for_(Halogen_Query_HalogenM.applicativeHalogenM)(Data_Foldable.foldableMaybe)(slug)((function () {
                                        var $546 = Conduit_Capability_Navigate.navigate(Conduit_Capability_Navigate.navigateHalogenM(dictNavigate));
                                        return function ($547) {
                                            return $546(Conduit_Data_Route.ViewArticle.create($547));
                                        };
                                    })());
                                });
                            });
                        });
                    };
                    throw new Error("Failed pattern match at Conduit.Page.Editor (line 75, column 18 - line 101, column 43): " + [ v.constructor.name ]);
                };
                return Component_HOC_Connect.component(dictMonadAff)(dictMonadAsk)()(Halogen_Component.mkComponent({
                    initialState: function (v) {
                        return {
                            article: Network_RemoteData.NotAsked.value,
                            currentUser: v.currentUser,
                            slug: v.slug
                        };
                    },
                    render: render,
                    "eval": Halogen_Component.mkEval({
                        handleAction: handleAction,
                        handleQuery: Halogen_Component.defaultEval.handleQuery,
                        receive: function ($548) {
                            return Data_Maybe.Just.create(Receive.create($548));
                        },
                        initialize: new Data_Maybe.Just(Initialize.value),
                        finalize: Halogen_Component.defaultEval.finalize
                    })
                }));
            };
        };
    };
};
export {
    Initialize,
    Receive,
    HandleEditor,
    component,
    EditorFields,
    HandleTagInput,
    formComponent,
    newtypeEditorFields
};
