// Generated by purs version 0.13.8
"use strict";
var Control_Alt = require("../Control.Alt/index.js");
var Control_Applicative = require("../Control.Applicative/index.js");
var Control_Bind = require("../Control.Bind/index.js");
var Data_Array = require("../Data.Array/index.js");
var Data_Char_Unicode = require("../Data.Char.Unicode/index.js");
var Data_Enum = require("../Data.Enum/index.js");
var Data_Int = require("../Data.Int/index.js");
var Data_Maybe = require("../Data.Maybe/index.js");
var Data_PreciseDate_Component = require("../Data.PreciseDate.Component/index.js");
var Data_RFC3339String = require("../Data.RFC3339String/index.js");
var Data_Semigroup = require("../Data.Semigroup/index.js");
var Data_String_CodeUnits = require("../Data.String.CodeUnits/index.js");
var Data_String_Common = require("../Data.String.Common/index.js");
var PreciseDateTime = (function () {
    function PreciseDateTime(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    PreciseDateTime.create = function (value0) {
        return function (value1) {
            return new PreciseDateTime(value0, value1);
        };
    };
    return PreciseDateTime;
})();
var toDateTimeLossy = function (v) {
    return v.value0;
};
var subsecondStringPadding = "000000000";
var padString = function (padding) {
    return function (fn) {
        return function (string) {
            return fn(string)(Data_String_CodeUnits.drop(Data_String_CodeUnits.length(string))(padding));
        };
    };
};
var padSubsecondString = padString(subsecondStringPadding);
var rightPadSubsecondString = padSubsecondString(Data_Semigroup.append(Data_Semigroup.semigroupString));
var parseSubseconds = function (v) {
    var parts = Data_String_Common.split(".")(v);
    return Control_Bind.bind(Data_Maybe.bindMaybe)(Data_Array.index(parts)(1))(function (afterDot) {
        var digits = Data_String_CodeUnits.takeWhile(Data_Char_Unicode.isDigit)(afterDot);
        return Control_Applicative.pure(Data_Maybe.applicativeMaybe)(rightPadSubsecondString(Data_String_CodeUnits.take(9)(digits)));
    });
};
var nanosecond = function (rfcString) {
    var nanoseconds = Control_Bind.composeKleisli(Data_Maybe.bindMaybe)(parseSubseconds)((function () {
        var $1813 = Data_String_CodeUnits.drop(3);
        return function ($1814) {
            return Data_Int.fromString($1813($1814));
        };
    })());
    return Control_Bind.bind(Data_Maybe.bindMaybe)(Control_Alt.alt(Data_Maybe.altMaybe)(nanoseconds(rfcString))(new Data_Maybe.Just(0)))(Data_Enum.toEnum(Data_PreciseDate_Component.boundedEnumNanosecond));
};
var fromRFC3339String = function (rfcString) {
    return Control_Bind.bind(Data_Maybe.bindMaybe)(Data_RFC3339String.toDateTime(rfcString))(function (dateTime) {
        return Control_Bind.bind(Data_Maybe.bindMaybe)(nanosecond(rfcString))(function (ns) {
            return Control_Applicative.pure(Data_Maybe.applicativeMaybe)(new PreciseDateTime(dateTime, ns));
        });
    });
};
module.exports = {
    PreciseDateTime: PreciseDateTime,
    fromRFC3339String: fromRFC3339String,
    toDateTimeLossy: toDateTimeLossy
};
