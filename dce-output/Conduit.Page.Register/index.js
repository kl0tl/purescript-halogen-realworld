// Generated by purs version 0.13.6
import * as Conduit_Capability_Navigate from "../Conduit.Capability.Navigate/index.js";
import * as Conduit_Capability_Resource_User from "../Conduit.Capability.Resource.User/index.js";
import * as Conduit_Component_HTML_Header from "../Conduit.Component.HTML.Header/index.js";
import * as Conduit_Component_HTML_Utils from "../Conduit.Component.HTML.Utils/index.js";
import * as Conduit_Data_Route from "../Conduit.Data.Route/index.js";
import * as Conduit_Form_Field from "../Conduit.Form.Field/index.js";
import * as Conduit_Form_Validation from "../Conduit.Form.Validation/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Semigroupoid from "../Control.Semigroupoid/index.js";
import * as DOM_HTML_Indexed_InputType from "../DOM.HTML.Indexed.InputType/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Function from "../Data.Function/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Monoid from "../Data.Monoid/index.js";
import * as Data_Newtype from "../Data.Newtype/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Symbol from "../Data.Symbol/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Formless_Class_Initial from "../Formless.Class.Initial/index.js";
import * as Formless_Component from "../Formless.Component/index.js";
import * as Formless_Internal_Transform from "../Formless.Internal.Transform/index.js";
import * as Formless_Transform_Record from "../Formless.Transform.Record/index.js";
import * as Formless_Transform_Row from "../Formless.Transform.Row/index.js";
import * as Formless_Types_Component from "../Formless.Types.Component/index.js";
import * as Formless_Types_Form from "../Formless.Types.Form/index.js";
import * as Formless_Validation from "../Formless.Validation/index.js";
import * as Halogen_Component from "../Halogen.Component/index.js";
import * as Halogen_HTML from "../Halogen.HTML/index.js";
import * as Halogen_HTML_Core from "../Halogen.HTML.Core/index.js";
import * as Halogen_HTML_Elements from "../Halogen.HTML.Elements/index.js";
import * as Halogen_HTML_Properties from "../Halogen.HTML.Properties/index.js";
import * as Halogen_Query_HalogenM from "../Halogen.Query.HalogenM/index.js";
import * as Heterogeneous_Mapping from "../Heterogeneous.Mapping/index.js";
var RegisterForm = function (x) {
    return x;
};
var HandleRegisterForm = (function () {
    function HandleRegisterForm(value0) {
        this.value0 = value0;
    };
    HandleRegisterForm.create = function (value0) {
        return new HandleRegisterForm(value0);
    };
    return HandleRegisterForm;
})();
var newtypeRegisterForm = new Data_Newtype.Newtype(function (n) {
    return n;
}, RegisterForm);
var component = function (dictMonadAff) {
    return function (dictManageUser) {
        return function (dictNavigate) {
            var render = function (v) {
                var formComponent = (function () {
                    var renderForm = function (v1) {
                        var proxies = Formless_Transform_Row.mkSProxies()(newtypeRegisterForm)(Formless_Transform_Row.makeSProxiesCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                            return "email";
                        }))()(Formless_Transform_Row.makeSProxiesCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                            return "password";
                        }))()(Formless_Transform_Row.makeSProxiesCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                            return "username";
                        }))()(Formless_Transform_Row.makeSProxiesNil))))(Formless_Types_Form.FormProxy.value);
                        var username = Conduit_Form_Field.input(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                            return "username";
                        }))(newtypeRegisterForm)(newtypeRegisterForm)()()(proxies.username)(v1.form)([ Halogen_HTML_Properties.placeholder("Username"), Halogen_HTML_Properties.type_(Halogen_HTML_Core.isPropInputType)(DOM_HTML_Indexed_InputType.InputText.value) ]);
                        var password = Conduit_Form_Field.input(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                            return "password";
                        }))(newtypeRegisterForm)(newtypeRegisterForm)()()(proxies.password)(v1.form)([ Halogen_HTML_Properties.placeholder("Password"), Halogen_HTML_Properties.type_(Halogen_HTML_Core.isPropInputType)(DOM_HTML_Indexed_InputType.InputPassword.value) ]);
                        var email = Conduit_Form_Field.input(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                            return "email";
                        }))(newtypeRegisterForm)(newtypeRegisterForm)()()(proxies.email)(v1.form)([ Halogen_HTML_Properties.placeholder("Email"), Halogen_HTML_Properties.type_(Halogen_HTML_Core.isPropInputType)(DOM_HTML_Indexed_InputType.InputEmail.value) ]);
                        return Halogen_HTML_Elements.form_([ Halogen_HTML_Elements.fieldset_([ username, email, password ]), Conduit_Form_Field.submit("Sign up") ]);
                    };
                    var formInput = function (v1) {
                        return {
                            validators: {
                                username: Control_Semigroupoid.composeFlipped(Formless_Validation.semigroupoidValidation(dictManageUser.Monad0()))(Conduit_Form_Validation.required(Data_Eq.eqString)(Data_Monoid.monoidString)(dictManageUser.Monad0()))(Conduit_Form_Validation.usernameFormat(dictManageUser.Monad0())),
                                email: Control_Semigroupoid.composeFlipped(Formless_Validation.semigroupoidValidation(dictManageUser.Monad0()))(Conduit_Form_Validation.required(Data_Eq.eqString)(Data_Monoid.monoidString)(dictManageUser.Monad0()))(Control_Semigroupoid.composeFlipped(Formless_Validation.semigroupoidValidation(dictManageUser.Monad0()))(Conduit_Form_Validation.minLength(dictManageUser.Monad0())(3))(Conduit_Form_Validation.emailFormat(dictManageUser.Monad0()))),
                                password: Control_Semigroupoid.composeFlipped(Formless_Validation.semigroupoidValidation(dictManageUser.Monad0()))(Conduit_Form_Validation.required(Data_Eq.eqString)(Data_Monoid.monoidString)(dictManageUser.Monad0()))(Control_Semigroupoid.composeFlipped(Formless_Validation.semigroupoidValidation(dictManageUser.Monad0()))(Conduit_Form_Validation.minLength(dictManageUser.Monad0())(8))(Conduit_Form_Validation.maxLength(dictManageUser.Monad0())(20)))
                            },
                            initialInputs: Data_Maybe.Nothing.value
                        };
                    };
                    return Formless_Component.component(dictMonadAff)()()(Data_Eq.eqRowCons(Data_Eq.eqRowCons(Data_Eq.eqRowCons(Data_Eq.eqRowNil)()(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "username";
                    }))(Formless_Types_Form.eqInputField(Data_Eq.eqString)))()(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "password";
                    }))(Formless_Types_Form.eqInputField(Data_Eq.eqString)))()(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "email";
                    }))(Formless_Types_Form.eqInputField(Data_Eq.eqString)))(Formless_Internal_Transform.inputFieldsToFormFieldsCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "email";
                    }))()(Formless_Internal_Transform.inputFieldsToFormFieldsCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "password";
                    }))()(Formless_Internal_Transform.inputFieldsToFormFieldsCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "username";
                    }))()(Formless_Internal_Transform.inputFieldsToFormFieldsNil)())())())(Formless_Internal_Transform.inputFieldsToInputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "email";
                    }))()(Formless_Internal_Transform.inputFieldsToInputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "password";
                    }))()(Formless_Internal_Transform.inputFieldsToInputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "username";
                    }))()(Formless_Internal_Transform.inputFieldsToInputNil)())())())(Formless_Internal_Transform.consCountErrors(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "email";
                    }))()(Formless_Internal_Transform.consCountErrors(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "password";
                    }))()(Formless_Internal_Transform.consCountErrors(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "username";
                    }))()(Formless_Internal_Transform.nilCountErrors))))(Formless_Internal_Transform.consAllTouched(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "email";
                    }))()(Formless_Internal_Transform.consAllTouched(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "password";
                    }))()(Formless_Internal_Transform.consAllTouched(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "username";
                    }))()(Formless_Internal_Transform.nilAllTouched))))(Formless_Internal_Transform.setFormFieldsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "email";
                    }))()(Formless_Internal_Transform.setFormFieldsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "password";
                    }))()(Formless_Internal_Transform.setFormFieldsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "username";
                    }))()(Formless_Internal_Transform.setFormFieldsTouchedNil)())())())(Formless_Internal_Transform.replaceFormFieldInputsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "email";
                    }))(Formless_Types_Form.newtypeInputField)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.replaceFormFieldInputsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "password";
                    }))(Formless_Types_Form.newtypeInputField)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.replaceFormFieldInputsTouchedCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "username";
                    }))(Formless_Types_Form.newtypeInputField)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.replaceFormFieldInputsTouchedNil))))(Formless_Internal_Transform.modifyAllCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "email";
                    }))(Formless_Types_Form.newtypeInputFunction)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.modifyAllCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "password";
                    }))(Formless_Types_Form.newtypeInputFunction)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.modifyAllCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "username";
                    }))(Formless_Types_Form.newtypeInputFunction)(Formless_Types_Form.newtypeFormField)()()()(Formless_Internal_Transform.modifyAllNil))))(Formless_Internal_Transform.applyToValidationCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "email";
                    }))(dictManageUser.Monad0())()(newtypeRegisterForm)()()(Formless_Internal_Transform.applyToValidationCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "password";
                    }))(dictManageUser.Monad0())()(newtypeRegisterForm)()()(Formless_Internal_Transform.applyToValidationCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "username";
                    }))(dictManageUser.Monad0())()(newtypeRegisterForm)()()(Formless_Internal_Transform.applyToValidationNil(dictManageUser.Monad0())))))(Formless_Internal_Transform.formFieldsToMaybeOutputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "email";
                    }))()(Formless_Internal_Transform.formFieldsToMaybeOutputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "password";
                    }))()(Formless_Internal_Transform.formFieldsToMaybeOutputCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "username";
                    }))()(Formless_Internal_Transform.formFieldsToMaybeOutputNil)())())())(Formless_Transform_Row.mkInputFieldsFromRowCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "email";
                    }))(Formless_Class_Initial.initialString)()(Formless_Transform_Row.mkInputFieldsFromRowCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "password";
                    }))(Formless_Class_Initial.initialString)()(Formless_Transform_Row.mkInputFieldsFromRowCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                        return "username";
                    }))(Formless_Class_Initial.initialString)()(Formless_Transform_Row.mkInputFieldsFromRowNil)())())())(newtypeRegisterForm)(newtypeRegisterForm)(newtypeRegisterForm)(newtypeRegisterForm)(newtypeRegisterForm)(newtypeRegisterForm)(newtypeRegisterForm)(newtypeRegisterForm)()()()()()()()()()(formInput)({
                        render: renderForm,
                        handleAction: Formless_Component.defaultSpec.handleAction,
                        handleQuery: Formless_Component.defaultSpec.handleQuery,
                        handleEvent: Formless_Component.raiseResult(newtypeRegisterForm)(Heterogeneous_Mapping.hmapRecord()(Heterogeneous_Mapping.mapRecordWithIndexCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                            return "email";
                        }))(Heterogeneous_Mapping.constMapping(Formless_Transform_Record.unwrapField(Formless_Types_Form.newtypeOutputField)))(Heterogeneous_Mapping.mapRecordWithIndexCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                            return "password";
                        }))(Heterogeneous_Mapping.constMapping(Formless_Transform_Record.unwrapField(Formless_Types_Form.newtypeOutputField)))(Heterogeneous_Mapping.mapRecordWithIndexCons(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                            return "username";
                        }))(Heterogeneous_Mapping.constMapping(Formless_Transform_Record.unwrapField(Formless_Types_Form.newtypeOutputField)))(Heterogeneous_Mapping.mapRecordWithIndexNil)()())()())()())),
                        receive: Formless_Component.defaultSpec.receive,
                        initialize: Formless_Component.defaultSpec.initialize,
                        finalize: Formless_Component.defaultSpec.finalize
                    });
                })();
                var container = function (html) {
                    return Halogen_HTML_Elements.div_([ Conduit_Component_HTML_Header.header(Data_Maybe.Nothing.value)(Conduit_Data_Route.Register.value), Halogen_HTML_Elements.div([ Conduit_Component_HTML_Utils.css("auth-page") ])([ Halogen_HTML_Elements.div([ Conduit_Component_HTML_Utils.css("container page") ])([ Halogen_HTML_Elements.div([ Conduit_Component_HTML_Utils.css("row") ])([ Halogen_HTML_Elements.div([ Conduit_Component_HTML_Utils.css("col-md-6 offset-md-3 col-xs12") ])(html) ]) ]) ]) ]);
                };
                return container([ Halogen_HTML_Elements.h1([ Conduit_Component_HTML_Utils.css("text-xs-center") ])([ Halogen_HTML_Core.text("Sign Up") ]), Halogen_HTML_Elements.p([ Conduit_Component_HTML_Utils.css("text-xs-center") ])([ Halogen_HTML_Elements.a([ Conduit_Component_HTML_Utils.safeHref(Conduit_Data_Route.Login.value) ])([ Halogen_HTML_Core.text("Already have an account?") ]) ]), Halogen_HTML.slot()(new Data_Symbol.IsSymbol(function ($dollar__unused) {
                    return "formless";
                }))(Data_Ord.ordUnit)(Formless_Types_Component["_formless"])(Data_Unit.unit)(formComponent)(Data_Unit.unit)(function ($700) {
                    return Data_Maybe.Just.create(HandleRegisterForm.create($700));
                }) ]);
            };
            var handleAction = function (v) {
                return Control_Bind.bind(Halogen_Query_HalogenM.bindHalogenM)(Conduit_Capability_Resource_User.registerUser(Conduit_Capability_Resource_User.manageUserHalogenM(dictManageUser))(v.value0))(Data_Foldable.traverse_(Halogen_Query_HalogenM.applicativeHalogenM)(Data_Foldable.foldableMaybe)(function (v1) {
                    return Conduit_Capability_Navigate.navigate(Conduit_Capability_Navigate.navigateHalogenM(dictNavigate))(Conduit_Data_Route.Home.value);
                }));
            };
            return Halogen_Component.mkComponent({
                initialState: Data_Function["const"](Data_Unit.unit),
                render: render,
                "eval": Halogen_Component.mkEval({
                    handleAction: handleAction,
                    handleQuery: Halogen_Component.defaultEval.handleQuery,
                    receive: Halogen_Component.defaultEval.receive,
                    initialize: Halogen_Component.defaultEval.initialize,
                    finalize: Halogen_Component.defaultEval.finalize
                })
            });
        };
    };
};
export {
    RegisterForm,
    HandleRegisterForm,
    component,
    newtypeRegisterForm
};
